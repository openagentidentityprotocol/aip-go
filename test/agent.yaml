apiVersion: aip.io/v1alpha1
kind: AgentPolicy
metadata:
  name: test-policy
spec:
  allowed_tools:
    - "list_files"
  # "delete_files" is implicitly blocked

  # Phase 3: Granular argument-level validation
  tool_rules:
    # GeminiJack Defense: Only allow GitHub URLs
    - tool: fetch_url
      allow_args:
        url: "^https://github\\.com/.*"

    # SQL Injection Defense: Only allow SELECT queries on safe databases
    - tool: run_query
      allow_args:
        database: "^(prod_readonly|staging)$"
        query: "^SELECT\\s+.*"
